{"ast":null,"code":"import { call, put, takeLatest } from \"redux-saga/effects\";\nimport { loginRequest, loginFailure, loginSuccess, joinSuccess, joinFailure, joinRequest, existSuccess, existFailure, existRequest, modifySuccess, modifyFailure, modifyRequest } from \"features/user/reducer/userSlice\";\nimport { userAPI } from \"features/user\";\n\n// function* token(action: PayloadAction<TokenPayload>) {\n//   // try {\n//   //   const {data} = await axios.post('/api/auth/signin', {email, password});\n//   //   console.log(data);\n//   try {\n//     const result: UserDataPayload = yield call(\n//       userAPI.tokenAPI,\n//       action.payload\n//     );\n//     dispatch(setToken(data.token))\n//     const { redirectUrl } = queryString.parse(props.location.search);\n//     if (redirectUrl) {\n//       props.history.push(redirectUrl);\n//     } else {\n//       props.history.push('/');\n//     }\n//   }\nfunction* exist(action) {\n  try {\n    const result = yield call(userAPI.existAPI, action.payload);\n    yield put(existSuccess(result));\n    alert(\"가능한 아이디입니다.\");\n  } catch (error) {\n    yield put(existFailure(error));\n    alert(error);\n    alert(\"쓸수없는 아이디입니다.\");\n  }\n}\n\nfunction* join(action) {\n  try {\n    console.log(action);\n    const result = yield call(userAPI.joinAPI, action.payload);\n    yield put(joinSuccess(result));\n    window.location.href = 'users/login';\n  } catch (error) {\n    // alert(\"아이디오류\")\n    yield put(joinFailure(error));\n  }\n}\n\nfunction* login(action) {\n  try {\n    const result = yield call(userAPI.loginAPI, action.payload);\n    console.log(`===========================서버에서 받은 값${JSON.stringify(result)}`); // alert(`===============payload=================${JSON.stringify(action.payload)}`)\n    // const token: UserDataPayload = yield call(\n    //   userAPI.tokenAPI,\n    //   action_t.payload\n    // );\n    //요청 성공시\n\n    yield put(loginSuccess(result));\n    alert(`=============result===================${JSON.stringify(result.data.user)}`);\n    alert(`=============token===================${JSON.stringify(result.data.user.token)}`); // window.localStorage.setItem('sessionToken', result.data.user.token)\n\n    window.localStorage.setItem('sessionUser', JSON.stringify(result.data.user)); // window.localStorage.setItem('sessionUser', JSON.stringify(result.config.data.username))\n    // window.localStorage.setItem('sessionModify', JSON.stringify(result.config.data))\n    // alert(`============= sessionToken - saved ===================${window.localStorage.getItem('sessionToken')}`)\n\n    alert(`============= sessionUser - saved ===================${window.localStorage.getItem('sessionUser')}`);\n    window.location.href = \"/home\";\n  } catch (error) {\n    alert(`error :: ${error}`);\n    alert(\"아이디 혹은 비밀번호가 틀렸습니다!\");\n    yield put(loginFailure(error));\n  }\n}\n\nfunction* modify(action) {\n  try {\n    const result = yield call(userAPI.modifyAPI, action.payload);\n    yield put(modifySuccess(result));\n    alert(`result? :: ${JSON.stringify(result.config)}`);\n    window.localStorage.setItem('sessionUser', JSON.stringify(JSON.parse(JSON.stringify(result.config.data)))); // alert(`SESSION 저장됨? ${window.localStorage.getItem('sessionUser')}`)\n\n    window.location.href = \"/mypage/setting\";\n  } catch (error) {\n    // alert(\"아이디오류\")\n    yield put(modifyFailure(error));\n  }\n} // Watch 함수\n\n\nexport function* watchLogin() {\n  yield takeLatest(loginRequest.type, login); // loginRequest에서의 type이 실행되면 login함수가 실행되는데\n  // loginRequest의 action이 있으면 그 액션이 login함수의 인자로 들어갑니다.\n}\nexport function* watchJoin() {\n  yield takeLatest(joinRequest.type, join);\n}\nexport function* watchExist() {\n  yield takeLatest(existRequest.type, exist);\n}\nexport function* watchModify() {\n  yield takeLatest(modifyRequest.type, modify);\n}","map":{"version":3,"sources":["C:/Users/bitcamp/Desktop/자비스12-21/jarviis-msa-frontend/src/features/user/module/userSaga.ts"],"names":["call","put","takeLatest","loginRequest","loginFailure","loginSuccess","joinSuccess","joinFailure","joinRequest","existSuccess","existFailure","existRequest","modifySuccess","modifyFailure","modifyRequest","userAPI","exist","action","result","existAPI","payload","alert","error","join","console","log","joinAPI","window","location","href","login","loginAPI","JSON","stringify","data","user","token","localStorage","setItem","getItem","modify","modifyAPI","config","parse","watchLogin","type","watchJoin","watchExist","watchModify"],"mappings":"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","sourcesContent":["import { PayloadAction } from \"@reduxjs/toolkit\";\nimport { call, delay, put, takeLatest } from \"redux-saga/effects\";\nimport {\n  LoginPayload,\n  UserDataPayload,\n  loginRequest,\n  loginFailure,\n  loginSuccess,\n  JoinPayload,\n  joinSuccess,\n  joinFailure,\n  joinRequest,\n  ExistPayload,\n  existSuccess,\n  existFailure,\n  existRequest,\n  ModifyPayload,\n  modifySuccess,\n  modifyFailure,\n  modifyRequest,\n  UserLoginDataPayload,\n} from \"features/user/reducer/userSlice\";\nimport { userAPI } from \"features/user\";\nimport { func } from \"prop-types\";\n\n\n// function* token(action: PayloadAction<TokenPayload>) {\n//   // try {\n//   //   const {data} = await axios.post('/api/auth/signin', {email, password});\n//   //   console.log(data);\n//   try {\n//     const result: UserDataPayload = yield call(\n//       userAPI.tokenAPI,\n//       action.payload\n//     );\n//     dispatch(setToken(data.token))\n//     const { redirectUrl } = queryString.parse(props.location.search);\n//     if (redirectUrl) {\n//       props.history.push(redirectUrl);\n//     } else {\n//       props.history.push('/');\n//     }\n//   }\n\nfunction* exist(action: PayloadAction<ExistPayload>) {\n    try {\n      const result: UserDataPayload = yield call(\n        userAPI.existAPI,\n        action.payload\n      );\n      yield put(existSuccess(result));\n      alert(\"가능한 아이디입니다.\")\n    } catch (error: any) {\n      yield put(existFailure(error))\n      alert(error)\n      alert(\"쓸수없는 아이디입니다.\")\n    }\n  }\n\n\n  function* join(action: PayloadAction<JoinPayload>) {\n    try {\n      console.log(action)\n      const result: UserDataPayload = yield call(\n\n        userAPI.joinAPI,\n        action.payload\n      );\n      yield put(joinSuccess(result));\n      window.location.href = 'users/login'\n    } catch (error: any) {\n      // alert(\"아이디오류\")\n      yield put(joinFailure(error));\n    }\n  }\n  function* login(action: PayloadAction<LoginPayload>) {\n    try {\n      const result: UserDataPayload = yield call(\n        userAPI.loginAPI,\n        action.payload\n      );\n      console.log(`===========================서버에서 받은 값${JSON.stringify(result)}`)\n      // alert(`===============payload=================${JSON.stringify(action.payload)}`)\n      // const token: UserDataPayload = yield call(\n      //   userAPI.tokenAPI,\n      //   action_t.payload\n      // );\n      //요청 성공시\n      yield put(loginSuccess(result));\n      alert(`=============result===================${JSON.stringify(result.data.user)}`)\n      alert(`=============token===================${JSON.stringify(result.data.user.token)}`)\n      // window.localStorage.setItem('sessionToken', result.data.user.token)\n      window.localStorage.setItem('sessionUser', JSON.stringify(result.data.user))\n      // window.localStorage.setItem('sessionUser', JSON.stringify(result.config.data.username))\n      // window.localStorage.setItem('sessionModify', JSON.stringify(result.config.data))\n      // alert(`============= sessionToken - saved ===================${window.localStorage.getItem('sessionToken')}`)\n      alert(`============= sessionUser - saved ===================${window.localStorage.getItem('sessionUser')}`)\n      window.location.href = \"/home\"\n    } catch (error: any) {\n      alert(`error :: ${error}`)\n      alert(\"아이디 혹은 비밀번호가 틀렸습니다!\")\n      yield put(loginFailure(error));\n    }\n  }\n  function* modify(action: PayloadAction<ModifyPayload>) {\n    try {\n      const result: UserLoginDataPayload = yield call(\n        userAPI.modifyAPI,\n        action.payload\n      );\n      yield put(modifySuccess(result));\n      alert(`result? :: ${JSON.stringify(result.config)}`)\n      window.localStorage.setItem('sessionUser', JSON.stringify(JSON.parse(JSON.stringify(result.config.data))))\n      // alert(`SESSION 저장됨? ${window.localStorage.getItem('sessionUser')}`)\n      window.location.href = \"/mypage/setting\"\n\n\n    } catch (error: any) {\n      // alert(\"아이디오류\")\n      yield put(modifyFailure(error));\n    }\n  }\n\n  // Watch 함수\n  export function* watchLogin() {\n    yield takeLatest(loginRequest.type, login);\n    // loginRequest에서의 type이 실행되면 login함수가 실행되는데\n    // loginRequest의 action이 있으면 그 액션이 login함수의 인자로 들어갑니다.\n  }\n  export function* watchJoin() {\n    yield takeLatest(joinRequest.type, join);\n  }\n  export function* watchExist() {\n    yield takeLatest(existRequest.type, exist);\n  }\n  export function* watchModify() {\n    yield takeLatest(modifyRequest.type, modify);\n  }"]},"metadata":{},"sourceType":"module"}